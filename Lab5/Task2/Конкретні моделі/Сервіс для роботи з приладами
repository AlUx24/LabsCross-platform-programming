package com.home.devices.service;

import com.home.devices.model.Appliance;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;

public class ApplianceService {

    private List<Appliance> appliances = new ArrayList<>();

    public void add(Appliance appliance) {
        appliances.add(appliance);
    }

    public void plugIn(int index) {
        if (index >= 0 && index < appliances.size()) {
            appliances.get(index).plugIn();
        }
    }

    public void showAll() {
        appliances.forEach(Appliance::showInfo);
    }

    public int getTotalPower() {
        return appliances.stream()
                .filter(Appliance::isPluggedIn)
                .mapToInt(Appliance::getPower)
                .sum();
    }

    public void sortByPower() {
        appliances.sort(Comparator.comparingInt(Appliance::getPower));
    }

    public List<Appliance> findByPowerRange(int min, int max) {
        List<Appliance> result = new ArrayList<>();
        for (Appliance a : appliances) {
            if (a.getPower() >= min && a.getPower() <= max) {
                result.add(a);
            }
        }
        return result;
    }
}
